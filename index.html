<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Luminary Photography — Aria</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #0e0d0b;
    --surface: #161410;
    --surface2: #1e1b16;
    --border: #2a2620;
    --gold: #c9a96e;
    --gold-dim: #8a6f44;
    --cream: #f0e8d8;
    --cream-dim: #9e9080;
    --white: #faf7f2;
    --user-bubble: #1e1b16;
    --aria-bubble: #141210;
    --accent: #c9a96e;
  }

  html, body {
    height: 100%;
    background: var(--bg);
    color: var(--cream);
    font-family: 'DM Sans', sans-serif;
    font-weight: 300;
    overflow: hidden;
  }

  /* Background texture */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: 
      radial-gradient(ellipse 80% 60% at 20% 0%, rgba(201,169,110,0.04) 0%, transparent 60%),
      radial-gradient(ellipse 60% 40% at 80% 100%, rgba(201,169,110,0.03) 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
  }

  .app {
    display: flex;
    flex-direction: column;
    height: 100vh;
    max-width: 780px;
    margin: 0 auto;
    position: relative;
    z-index: 1;
  }

  /* Header */
  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px 28px 18px;
    border-bottom: 1px solid var(--border);
    background: rgba(14,13,11,0.95);
    backdrop-filter: blur(12px);
    flex-shrink: 0;
  }

  .header-left {
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .avatar {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    background: linear-gradient(135deg, #2a2218 0%, #1a1610 100%);
    border: 1px solid var(--gold-dim);
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Cormorant Garamond', serif;
    font-size: 18px;
    color: var(--gold);
    position: relative;
    flex-shrink: 0;
  }

  .avatar::after {
    content: '';
    position: absolute;
    bottom: 2px;
    right: 2px;
    width: 9px;
    height: 9px;
    background: #4caf7d;
    border-radius: 50%;
    border: 2px solid var(--bg);
  }

  .header-info h1 {
    font-family: 'Cormorant Garamond', serif;
    font-size: 18px;
    font-weight: 400;
    color: var(--white);
    letter-spacing: 0.02em;
    line-height: 1;
  }

  .header-info p {
    font-size: 11px;
    color: var(--gold);
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin-top: 3px;
    font-weight: 400;
  }

  .header-right {
    font-family: 'Cormorant Garamond', serif;
    font-size: 13px;
    color: var(--gold-dim);
    letter-spacing: 0.08em;
    text-align: right;
    font-style: italic;
  }

  .header-right span {
    display: block;
    font-style: normal;
    font-size: 11px;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: #4a4030;
    margin-top: 2px;
    font-family: 'DM Sans', sans-serif;
  }

  /* Messages */
  .messages {
    flex: 1;
    overflow-y: auto;
    padding: 28px 28px 16px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    scroll-behavior: smooth;
  }

  .messages::-webkit-scrollbar { width: 4px; }
  .messages::-webkit-scrollbar-track { background: transparent; }
  .messages::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }

  .message {
    display: flex;
    gap: 12px;
    animation: msgIn 0.35s cubic-bezier(0.16, 1, 0.3, 1) both;
  }

  @keyframes msgIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .message.user {
    flex-direction: row-reverse;
  }

  .msg-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 13px;
    margin-top: 2px;
  }

  .message.aria .msg-avatar {
    background: linear-gradient(135deg, #2a2218, #1a1610);
    border: 1px solid var(--gold-dim);
    font-family: 'Cormorant Garamond', serif;
    color: var(--gold);
  }

  .message.user .msg-avatar {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--cream-dim);
    font-size: 11px;
    letter-spacing: 0.05em;
    font-weight: 500;
  }

  .bubble {
    max-width: 72%;
    padding: 14px 18px;
    border-radius: 2px;
    line-height: 1.65;
    font-size: 14.5px;
    position: relative;
  }

  .message.aria .bubble {
    background: var(--aria-bubble);
    border: 1px solid var(--border);
    color: var(--cream);
    border-top-left-radius: 0;
  }

  .message.user .bubble {
    background: var(--surface2);
    border: 1px solid #2e2a22;
    color: var(--cream-dim);
    border-top-right-radius: 0;
  }

  /* Aria name label */
  .msg-name {
    font-size: 10px;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--gold-dim);
    margin-bottom: 6px;
    font-weight: 500;
  }

  /* Typing indicator */
  .typing {
    display: flex;
    gap: 12px;
    align-items: flex-start;
    animation: msgIn 0.3s ease both;
  }

  .typing-bubble {
    background: var(--aria-bubble);
    border: 1px solid var(--border);
    padding: 14px 18px;
    border-radius: 2px;
    border-top-left-radius: 0;
    display: flex;
    gap: 5px;
    align-items: center;
  }

  .dot {
    width: 5px;
    height: 5px;
    border-radius: 50%;
    background: var(--gold-dim);
    animation: pulse 1.4s ease-in-out infinite;
  }
  .dot:nth-child(2) { animation-delay: 0.2s; }
  .dot:nth-child(3) { animation-delay: 0.4s; }

  @keyframes pulse {
    0%, 60%, 100% { opacity: 0.3; transform: scale(1); }
    30% { opacity: 1; transform: scale(1.2); }
  }

  /* Quick replies */
  .quick-replies {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    padding: 0 28px 4px;
    animation: msgIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) both;
  }

  .qr-btn {
    background: transparent;
    border: 1px solid var(--gold-dim);
    color: var(--gold);
    padding: 7px 15px;
    font-family: 'DM Sans', sans-serif;
    font-size: 12.5px;
    font-weight: 400;
    letter-spacing: 0.06em;
    cursor: pointer;
    border-radius: 1px;
    transition: all 0.2s ease;
    white-space: nowrap;
  }

  .qr-btn:hover {
    background: rgba(201,169,110,0.08);
    border-color: var(--gold);
    color: var(--cream);
  }

  /* Input area */
  .input-area {
    padding: 16px 28px 24px;
    border-top: 1px solid var(--border);
    background: rgba(14,13,11,0.95);
    backdrop-filter: blur(12px);
    flex-shrink: 0;
  }

  .input-row {
    display: flex;
    gap: 10px;
    align-items: flex-end;
  }

  .input-wrap {
    flex: 1;
    position: relative;
  }

  textarea {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 2px;
    padding: 12px 16px;
    color: var(--cream);
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    font-weight: 300;
    resize: none;
    outline: none;
    line-height: 1.5;
    min-height: 46px;
    max-height: 120px;
    transition: border-color 0.2s;
    overflow-y: auto;
  }

  textarea::placeholder { color: #4a4438; }
  textarea:focus { border-color: var(--gold-dim); }

  .send-btn {
    width: 46px;
    height: 46px;
    background: var(--gold);
    border: none;
    border-radius: 2px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.2s ease;
  }

  .send-btn:hover { background: #d9b97e; }
  .send-btn:active { transform: scale(0.96); }
  .send-btn:disabled { background: var(--gold-dim); opacity: 0.4; cursor: not-allowed; }

  .send-btn svg { width: 18px; height: 18px; fill: var(--bg); }

  .input-hint {
    font-size: 11px;
    color: #3a3428;
    margin-top: 8px;
    letter-spacing: 0.05em;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .input-hint::before {
    content: '';
    display: inline-block;
    width: 16px;
    height: 1px;
    background: #3a3428;
  }

  /* Lead collected badge */
  .lead-badge {
    background: linear-gradient(135deg, #1a1f14, #141a10);
    border: 1px solid #3a5030;
    border-radius: 2px;
    padding: 12px 16px;
    margin: 0 28px;
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 12px;
    color: #6aab5a;
    letter-spacing: 0.08em;
    animation: msgIn 0.4s ease both;
  }

  .lead-badge-dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
    background: #4caf7d;
    flex-shrink: 0;
    box-shadow: 0 0 8px rgba(76,175,125,0.5);
  }

  /* Divider */
  .divider {
    display: flex;
    align-items: center;
    gap: 14px;
    padding: 4px 0;
    color: #3a3428;
    font-size: 10px;
    letter-spacing: 0.14em;
    text-transform: uppercase;
  }

  .divider::before, .divider::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border);
  }

  /* Powered by */
  .powered {
    text-align: center;
    font-size: 10px;
    color: #2e2820;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    padding: 0 0 2px;
    margin-top: 8px;
  }

  .powered a {
    color: #4a4030;
    text-decoration: none;
    transition: color 0.2s;
  }

  .powered a:hover { color: var(--gold-dim); }

  /* Scrollbar for textarea */
  textarea::-webkit-scrollbar { width: 3px; }
  textarea::-webkit-scrollbar-thumb { background: var(--border); }

  @media (max-width: 600px) {
    .header { padding: 16px 18px; }
    .header-right { display: none; }
    .messages { padding: 20px 18px 12px; }
    .quick-replies { padding: 0 18px 4px; }
    .input-area { padding: 14px 18px 20px; }
    .bubble { max-width: 88%; font-size: 14px; }
    .lead-badge { margin: 0 18px; }
  }
</style>
</head>
<body>

<div class="app">

  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <div class="avatar">A</div>
      <div class="header-info">
        <h1>Aria</h1>
        <p>Luminary Photography · Assistant</p>
      </div>
    </div>
    <div class="header-right">
      Available 24 / 7
      <span>Instant reply</span>
    </div>
  </div>

  <!-- Messages -->
  <div class="messages" id="messages"></div>

  <!-- Quick replies container -->
  <div id="quick-replies"></div>

  <!-- Lead badge (hidden until collected) -->
  <div class="lead-badge" id="lead-badge" style="display:none;">
    <div class="lead-badge-dot"></div>
    <span id="lead-badge-text">Lead captured — photographer notified via SMS</span>
  </div>

  <!-- Input -->
  <div class="input-area">
    <div class="input-row">
      <div class="input-wrap">
        <textarea 
          id="input" 
          placeholder="Type a message..." 
          rows="1"
          onkeydown="handleKey(event)"
          oninput="autoResize(this)"
        ></textarea>
      </div>
      <button class="send-btn" id="send-btn" onclick="sendMessage()">
        <svg viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
      </button>
    </div>
    <div class="input-hint">Aria responds instantly, day or night</div>
    <div class="powered">Powered by <a href="https://isaacautomation.com" target="_blank">Isaac Automation Group</a></div>
  </div>

</div>

<script>
// ─── CONFIG ───────────────────────────────────────────────────────────────────
const API_KEY = 'YOUR_CLAUDE_API_KEY'; // Replace with actual key for deployment

const SYSTEM_PROMPT = `You are Aria, the AI assistant for Luminary Photography — a professional photography studio serving clients for weddings, portraits, engagements, family sessions, brand/commercial shoots, and events.

Your goal: Make every potential client feel seen, answer their questions warmly, and collect their lead information so the photographer can follow up personally.

PERSONALITY:
- Warm, elegant, and professional — like a trusted concierge, not a chatbot
- Speak in short, natural sentences. Never robotic or list-heavy
- Use the client's name once you have it
- Show genuine interest in what they're celebrating or creating

WHAT YOU KNOW ABOUT LUMINARY PHOTOGRAPHY:
- Services: Weddings, engagements, portraits, family sessions, maternity, newborns, senior portraits, brand/commercial, events
- Style: Timeless, editorial, authentic — a mix of candid moments and refined portraits
- Turnaround: Galleries delivered within 3–4 weeks via private online gallery
- Includes: Full-resolution digital images, print release, private gallery link
- Pricing: Starts at $350 for mini sessions; full sessions and weddings require a custom quote based on date, hours, and coverage needs
- Booking: Requires a signed contract and 25% retainer to hold the date
- Location: Available locally and for travel bookings

LEAD COLLECTION FLOW:
Once you've answered their initial question or after 2-3 exchanges, naturally guide them to share:
1. Their first name
2. What type of session they're interested in
3. The event/session date (or approximate timeframe)
4. Their email address

When you have all 4, end with: "Perfect — I've passed your details along to our photographer and you'll hear back within 24 hours. We'd love to work with you!"

Then output this exact line on its own (the app uses it to show the lead badge):
LEAD_COLLECTED

IMPORTANT RULES:
- Never give exact wedding pricing — always say it's custom based on coverage needs and invite them to share their date
- Keep responses to 2-4 sentences max
- Never say you're an AI unless directly asked — if asked, say "I'm Aria, the studio's virtual assistant"
- If they seem hesitant about price, gently mention the value: "Every gallery includes full-resolution images and a print release — no hidden costs"`;

// ─── STATE ────────────────────────────────────────────────────────────────────
let conversationHistory = [];
let isTyping = false;
let leadCollected = false;

// ─── INIT ─────────────────────────────────────────────────────────────────────
window.onload = () => {
  setTimeout(() => {
    addMessage('aria', "Hi! I'm Aria, the virtual assistant for Luminary Photography. Whether you're planning a wedding, a portrait session, or something in between — I'm here to help. What brings you in today?");
    setTimeout(() => {
      showQuickReplies([
        'Wedding photography',
        'Portrait session',
        'Family photos',
        'Brand / commercial',
        'Just browsing'
      ]);
    }, 400);
  }, 600);
};

// ─── MESSAGES ─────────────────────────────────────────────────────────────────
function addMessage(role, text) {
  const container = document.getElementById('messages');
  clearQuickReplies();

  const wrapper = document.createElement('div');
  wrapper.className = `message ${role}`;

  const avatarEl = document.createElement('div');
  avatarEl.className = 'msg-avatar';
  avatarEl.textContent = role === 'aria' ? 'A' : 'You';

  const bubbleWrap = document.createElement('div');
  const nameEl = document.createElement('div');
  nameEl.className = 'msg-name';
  nameEl.textContent = role === 'aria' ? 'Aria' : 'You';

  const bubble = document.createElement('div');
  bubble.className = 'bubble';
  bubble.textContent = text;

  bubbleWrap.appendChild(nameEl);
  bubbleWrap.appendChild(bubble);
  wrapper.appendChild(avatarEl);
  wrapper.appendChild(bubbleWrap);
  container.appendChild(wrapper);
  scrollToBottom();
}

function showTyping() {
  const container = document.getElementById('messages');
  const el = document.createElement('div');
  el.className = 'typing';
  el.id = 'typing';

  const av = document.createElement('div');
  av.className = 'msg-avatar';
  av.style.cssText = 'width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,#2a2218,#1a1610);border:1px solid #8a6f44;display:flex;align-items:center;justify-content:center;font-family:Cormorant Garamond,serif;color:#c9a96e;font-size:13px;margin-top:2px;flex-shrink:0';
  av.textContent = 'A';

  const tb = document.createElement('div');
  tb.className = 'typing-bubble';
  for (let i = 0; i < 3; i++) {
    const d = document.createElement('div');
    d.className = 'dot';
    tb.appendChild(d);
  }

  el.appendChild(av);
  el.appendChild(tb);
  container.appendChild(el);
  scrollToBottom();
}

function removeTyping() {
  const el = document.getElementById('typing');
  if (el) el.remove();
}

function showQuickReplies(options) {
  const container = document.getElementById('quick-replies');
  container.innerHTML = '';
  const wrap = document.createElement('div');
  wrap.className = 'quick-replies';
  options.forEach(opt => {
    const btn = document.createElement('button');
    btn.className = 'qr-btn';
    btn.textContent = opt;
    btn.onclick = () => {
      clearQuickReplies();
      processUserMessage(opt);
    };
    wrap.appendChild(btn);
  });
  container.appendChild(wrap);
}

function clearQuickReplies() {
  document.getElementById('quick-replies').innerHTML = '';
}

function scrollToBottom() {
  const c = document.getElementById('messages');
  c.scrollTop = c.scrollHeight;
}

// ─── SEND ─────────────────────────────────────────────────────────────────────
async function sendMessage() {
  const input = document.getElementById('input');
  const text = input.value.trim();
  if (!text || isTyping) return;
  input.value = '';
  autoResize(input);
  processUserMessage(text);
}

async function processUserMessage(text) {
  if (isTyping || leadCollected) return;
  isTyping = true;
  setSendDisabled(true);

  addMessage('user', text);
  conversationHistory.push({ role: 'user', content: text });

  showTyping();

  try {
    const response = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'x-api-key': API_KEY,
        'anthropic-version': '2023-06-01',
        'anthropic-dangerous-direct-browser-access': 'true'
      },
      body: JSON.stringify({
        model: 'claude-haiku-4-5-20251001',
        max_tokens: 400,
        system: SYSTEM_PROMPT,
        messages: conversationHistory
      })
    });

    const data = await response.json();
    const raw = data.content?.[0]?.text || "I'm sorry, something went wrong. Please try again.";

    // Check for lead collected signal
    const hasLead = raw.includes('LEAD_COLLECTED');
    const clean = raw.replace('LEAD_COLLECTED', '').trim();

    removeTyping();
    addMessage('aria', clean);
    conversationHistory.push({ role: 'assistant', content: raw });

    if (hasLead) {
      leadCollected = true;
      setTimeout(() => {
        document.getElementById('lead-badge').style.display = 'flex';
        scrollToBottom();
      }, 600);
    }

  } catch (err) {
    removeTyping();
    addMessage('aria', "I'm having a moment — please try again shortly.");
    console.error(err);
  }

  isTyping = false;
  setSendDisabled(false);
}

// ─── HELPERS ──────────────────────────────────────────────────────────────────
function handleKey(e) {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
}

function autoResize(el) {
  el.style.height = 'auto';
  el.style.height = Math.min(el.scrollHeight, 120) + 'px';
}

function setSendDisabled(val) {
  document.getElementById('send-btn').disabled = val;
}
</script>
</body>
</html>
